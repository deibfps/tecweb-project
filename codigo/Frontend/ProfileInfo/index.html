<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Información del Perfil - Plantasia</title>
    <link rel="stylesheet" href="../variables.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    
    <header>
        <h1>Plantasia</h1>
        <nav>
            <ul>
                <li><a href="../Home/index.html">Home</a></li>
                <li><a href="../Home/index.html #SobreNosotros">Nosotros</a></li>
                <li><a href="../Profile/index.html">Perfil</a></li>
                </ul>
        </nav>
    </header>

    <main>
        <section class="profile-info">
            <div class="profile-content">
                <div class="profile-image">
                    <img class="avatar" id="user-avatar" src="https://images.icon-icons.com/3873/PNG/512/profile_circle_icon_244573.png"/>
                    <div class="edit-img">
                        <img class="edit-icon" src="https://icones.pro/wp-content/uploads/2021/02/icono-de-camara-gris.png"/>
                    </div>
                </div>

                <div class="profile-text">
                    <h4>Tu perfil</h4>
                    <h2>
                        <span id="nombre"></span> 
                        <span id="apellido"></span>
                    </h2>
                    <p>
                        <span id="pronombres"></span> 
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
                        <span id="fecha-nacimiento"></span>
                    </p>
                    <p id="biografia">
                        
                    </p>
                    <button class="submit" onclick="editarPerfil()">Editar mi perfil</button>
                    <button class="logout" onclick="logout()" style="margin-top:10px;">Cerrar sesión</button>
                </div>
            </div>
        </section>
    </main>

     <footer>
        <div id="Plantasia">
        Plantasia
        </div>
        <div id="Copyright">
        Todos los derechos reservados<br>
        © 2025 Plantasia
        </div>
    </footer>

    <script>
document.addEventListener('DOMContentLoaded', function() {
    const id_usuario = localStorage.getItem('id_usuario');
    if (!id_usuario) {
        window.location.href = '../Login/index.html';
        return;
    }

    // Obtén los datos del perfil y muéstralos
    fetch(`http://localhost:8080/api/perfil/${id_usuario}`)
        .then(res => res.json())
        .then(data => {
            if (data.exists) {
                document.getElementById('nombre').textContent = data.perfil.nombre;
                document.getElementById('apellido').textContent = data.perfil.apellido;
                document.getElementById('pronombres').textContent = data.perfil.pronombres;
                document.getElementById('fecha-nacimiento').textContent = data.perfil.fecha_nacimiento;
                document.getElementById('biografia').textContent = data.perfil.biografia;
            } else {
                window.location.href = '../Profile/index.html';
            }
        })
        .catch(() => alert('Error al cargar el perfil'));
});

// Función para cerrar sesión
function logout() {
    localStorage.removeItem('usuarioLogueado');
    localStorage.removeItem('rol');
    localStorage.removeItem('id_usuario');
    window.location.href = '../Login/index.html';
}

function editarPerfil() {
    window.location.href = '../Profile/index.html?edit=1';
}
</script>
</body>
</html>